# age-of-elements #
Age of Elements is an LPMud game library that runs on the LDMud game driver.

The topdirectory contains these files and directories:

* `ACCESS.ALLOW` the usual access definition file
* `WELCOME, NEWS, WIZNEWS` the messages printed on login
* `WIZLIST` the wizlist savefile
* `doc/` mudlib-specific documentation, to be complemented with the doc/ files from the driver distribution.
* `include/` header files
* `log/` logfiles generated by the mudlib
* `obj/` game objects
* `players/` player savefiles and wizard directories
* `room/` game rooms and include files
* `sys/` include files, including those from the driver distribution

## Getting Started on Amazon Linux 2
Amazon Web Services fees will apply.
### Install LDMud Game Driver Dependencies
Install the standard developer tools, then tools for mysql, json-c, XML2 and OpenSSL. 
```
sudo yum groupinstall "Development Tools"
sudo yum install mysql-devel
sudo yum -y install json-c-devel
sudo yum -y install libxml2-devel
sudo yum -y install openssl-devel
```
### Install LDMud Game Driver
Clone the game driver from the repository, detach it from source control, prep the game driver for the operating system.
```
cd ~/
git clone https://github.com/ldmud/ldmud.git
cd ldmud
rm -rf .git
./autogen.sh
cd ~/ldmud/src/settings
```
### Configure Your Game Driver Installation
Use `nano` or `vi` to create a settings file called `aoe`.
```perl
#!/bin/sh
#
# Settings for Age of Elements running a native mode driver.
#
# configure will strip this part from the script.

exec ./configure --prefix=/home/ec2-user/ldmud --libdir=/home/ec2-user/ldmud/age-of-elements --with-setting=aoe $*
exit 1

# --- The actual settings ---

enable_erq=erq
enable_compat_mode=no
enable_strict_euids=no
enable_use_parse_command=no
enable_use_mysql=yes
enable_use_pcre=yes
enable_use_tls=ssl
enable_use_json=yes
enable_use_xml=yes

with_master_name=secure/master
with_portno=7680
with_udp_port=7681
```
Set permissions with `chmod ug+rw aoe` and `chmod o+x aoe`.
Run the configuration script, compile then install the game driver.
```
cd ~/ldmud/src
./configure --prefix=/home/ec2-user/ldmud --libdir=/home/ec2-user/ldmud/age-of-elements --with-setting=aoe
settings/aoe
make
make install
make install-all
```
### Install Age of Elements Mud Library
Clone the mudlib 
```
cd ~/ldmud
git clone https://github.com/age-of-elements/age-of-elements.git
```
Use `nano` or `vi` to create a startup script in the `~/ldmud/bin` directory called `startup`.
```perl
ROOT=/home/ec2-user/ldmud
GAME=`ps -ec | awk '/ ldmud$/ { print $1 }'`

if test "$GAME" = ""
then

#If you have email running, uncomment these
#mail -s "Age of Elements startup" your@email.com << EOF
#Age of Elements startup at `date`.
#EOF

#Setup default permissions for the mudlib
umask u=rwx,g=rwx,o=
cd $ROOT
chmod g+s age-of-elements
chgrp ec2-user age-of-elements

#Make a copy of old runtime logs.
cd $ROOT/age-of-elements/log
touch driver_runtime.log
mv -f driver_runtime.log driver_runtime.log.old
touch driver_compiletime.log
mv -f driver_compiletime.log driver_compiletime.log.old

#Start the driver.
cd $ROOT/bin
./ldmud --debug-file $ROOT/age-of-elements/log/driver_runtime.log --hard-malloc-limit 0 7680 >& $ROOT/age-of-elements/log/driver_compiletime.log &

else

echo Game already running under PID $GAME

fi
```
Set permissions with `chmod ug+rw startup` and `chmod o+x startup`.
### Start the Game
In the `~/ldmud/bin`, find the driver binary and your startup script.  Start the game, then connect with telnet.
```
./startup &
telnet localhost 7680
```
